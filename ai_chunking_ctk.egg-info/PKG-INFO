Metadata-Version: 2.4
Name: ai-chunking-ctk
Version: 0.2.0
Summary: Enterprise-grade context-aware semantic chunking library powered by LLMs.
Author-email: Antigravity <assistant@deepmind.com>
Project-URL: Homepage, https://github.com/example/ai-chunking
Project-URL: Documentation, https://github.com/example/ai-chunking#readme
Project-URL: Source, https://github.com/example/ai-chunking
Classifier: Development Status :: 4 - Beta
Classifier: Intended Audience :: Developers
Classifier: Programming Language :: Python :: 3.9
Classifier: Programming Language :: Python :: 3.10
Classifier: Programming Language :: Python :: 3.11
Classifier: License :: OSI Approved :: MIT License
Classifier: Operating System :: OS Independent
Classifier: Topic :: Scientific/Engineering :: Artificial Intelligence
Requires-Python: >=3.9
Description-Content-Type: text/markdown
Requires-Dist: pydantic>=2.0.0
Requires-Dist: tenacity>=8.0.0
Requires-Dist: openai>=1.0.0
Requires-Dist: tiktoken>=0.5.0

# ğŸ§  Smart AI Chunking

**Context-Aware Semantic Chunking for RAG**

Smart AI Chunking æ˜¯ä¸€ä¸ªä¸“ä¸ºå¤§æ¨¡å‹ï¼ˆRAGï¼‰è®¾è®¡çš„é«˜çº§æ–‡æœ¬åˆ‡åˆ†åº“ã€‚ä¸ä¼ ç»Ÿçš„å›ºå®šé•¿åº¦åˆ‡åˆ†ï¼ˆFixed-Size Chunkingï¼‰ä¸åŒï¼Œå®ƒé‡‡ç”¨**â€œå…ˆç†è§£ï¼Œååˆ‡åˆ†â€**çš„ä¸¤é˜¶æ®µç­–ç•¥ï¼Œç¡®ä¿æ¯ä¸ªåˆ‡ç‰‡éƒ½åŒ…å«å®Œæ•´çš„è¯­ä¹‰å’Œå…¨å±€ä¸Šä¸‹æ–‡ã€‚

---

## âœ¨ æ ¸å¿ƒç‰¹æ€§

- **ğŸ§  å…¨å±€ä¸Šä¸‹æ–‡æ„ŸçŸ¥ (Context-Aware)**: åœ¨åˆ‡åˆ†å‰å…ˆç”± AI é€šè¯»å…¨æ–‡ï¼Œæå–å™äº‹å¤§çº²ï¼ˆNarrativeï¼‰å’Œå…¨å±€æ‘˜è¦ã€‚åˆ‡åˆ†æ—¶ï¼Œæ¯ä¸ªå—éƒ½çŸ¥é“è‡ªå·±åœ¨å…¨æ–‡ä¸­çš„ä½ç½®ã€‚
- **ğŸ”ª è¯­ä¹‰åæ ‡åˆ‡åˆ† (Coordinate Splitting)**: ä¸å†æœºæ¢°åœ°æŒ‰ xxx å­—åˆ‡ä¸€åˆ€ï¼Œè€Œæ˜¯é€šè¿‡åœ¨æ–‡æœ¬ä¸­åŸ‹å…¥éšå½¢åæ ‡ï¼Œè®© LLM å†³å®šæœ€è‡ªç„¶çš„è¯­ä¹‰æ–­ç‚¹ã€‚
- **ğŸš€ å…¨å¹¶å‘åŠ é€Ÿ (High Performance)**: é‡‡ç”¨å¼‚æ­¥æµæ°´çº¿è®¾è®¡ï¼Œæ–‡æ¡£æ‰«æã€æ‘˜è¦ç”Ÿæˆã€åˆ‡ç‰‡å¤„ç†å…¨éƒ¨å¹¶å‘æ‰§è¡Œï¼Œé€Ÿåº¦æå¿«ã€‚
- **ğŸ“ æ ‡å‡†åŒ–è¾“å‡º**: æ¯ä¸ªå—ä¸ä»…åŒ…å«æ–‡æœ¬ï¼Œè¿˜åŒ…å«**æ ‡é¢˜**ã€**æ‘˜è¦**å’Œ**ä¸Šä¸‹æ–‡å…ƒæ•°æ®**ã€‚

---

## ğŸ“¦ å®‰è£…

*(å‡è®¾æœ¬é¡¹ç›®ä½œä¸ºæœ¬åœ°åŒ…ä½¿ç”¨)*

```bash
git clone https://github.com/your-repo/ai-chunking.git
cd ai-chunking
pip install -r requirements.txt
```

---

## âš¡ å¿«é€Ÿå¼€å§‹

ä½¿ç”¨æˆ‘ä»¬æä¾›çš„é«˜çº§ APIï¼Œåªéœ€å‡ è¡Œä»£ç å³å¯å®Œæˆæ™ºèƒ½åˆ‡åˆ†ã€‚

```python
import asyncio
import json
from ai_chunking import smart_chunk_file, get_openai_wrapper

my_llm = get_openai_wrapper(
    api_key="sk-...", 
    base_url="https://...", 
    model="deepseek-ai/deepseek-v3.2",
    concurrency=20  # å¹¶å‘æ•°é‡
)

async def main():
    file_path = "document.md"
    
    print(f"å¼€å§‹å¤„ç†: {file_path}")
    
    async for chunk in smart_chunk_file(
        file_path=file_path,
        llm_func=my_llm,
        target_tokens=3500,     # æ¯ä¸ªå—çš„ç›®æ ‡é•¿åº¦
        max_llm_context=256000  # æ¨¡å‹çš„æœ€å¤§ä¸Šä¸‹æ–‡çª—å£
    ):
        # æ‰“å°å®Œæ•´çš„ JSON ç»“æœ
        print(json.dumps(chunk, indent=2, ensure_ascii=False))

if __name__ == "__main__":
    asyncio.run(main())
```

---

## ğŸ› ï¸ API è¯´æ˜

### `smart_chunk_file`

è¿™æ˜¯æœ¬åº“çš„æ ¸å¿ƒå…¥å£å‡½æ•°ã€‚

```python
async def smart_chunk_file(
    file_path: str | Path,
    llm_func: Callable[[str], Awaitable[str]],
    target_tokens: int,
    max_llm_context: int
) -> AsyncGenerator[Dict, None]
```

#### å‚æ•°
- **`file_path`**: ç›®æ ‡ Markdown æˆ–æ–‡æœ¬æ–‡ä»¶è·¯å¾„ã€‚
- **`llm_func`**: ç”¨æˆ·æä¾›çš„å¼‚æ­¥ LLM è°ƒç”¨å‡½æ•°ã€‚æ¥æ”¶ `prompt` (str)ï¼Œè¿”å› `response` (str)ã€‚
- **`target_tokens`**: **(å¿…å¡«)** æ¯ä¸ªåˆ‡ç‰‡çš„æœŸæœ› Token æ•°ï¼ˆä¾‹å¦‚ 2000-4000ï¼‰ã€‚å»ºè®®è®¾ä¸ºæ¨¡å‹ä¸Šä¸‹æ–‡çš„ 1/3 åˆ° 1/10ã€‚
- **`max_llm_context`**: **(å¿…å¡«)** å½“å‰ LLM çš„æœ€å¤§ä¸Šä¸‹æ–‡çª—å£ï¼ˆä¾‹å¦‚ 128000ï¼‰ã€‚ç³»ç»Ÿä¼šæ ¹æ®æ­¤å€¼è‡ªåŠ¨ä¼˜åŒ–æ‰«ææ­¥é•¿ã€‚

#### è¿”å›å€¼
å¼‚æ­¥ç”Ÿæˆå™¨ï¼Œäº§å‡ºå¦‚ä¸‹å­—å…¸ç»“æ„ï¼š

```json
{
  "chunk_id": "ck_001",
  "title": "Introduction to AI Chunking",
  "summary": "This section introduces the concept of semantic chunking...",
  "content": "Full text content of this chunk...",
  "tokens": 850
}
```

---

## âš™ï¸ åŸç†ç®€ä»‹

1.  **Phase 1: Scanner (å…¨çŸ¥æ‰«æ)**
    *   ç³»ç»Ÿé¦–å…ˆå¿«é€Ÿæ‰«ææ•´ç¯‡æ–‡æ¡£ã€‚
    *   ç”Ÿæˆä¸€ä»½ç”±æ­¤åŠå½¼çš„ **å™äº‹å¤§çº² (Narrative Plan)**ã€‚
    *   ä¸ºåç»­åˆ‡åˆ†æä¾›â€œä¸Šå¸è§†è§’â€ã€‚

2.  **Phase 2: Splitter (åæ ‡åˆ‡åˆ†)**
    *   æ ¹æ®ç›®æ ‡ Token æ•°ï¼Œå°†æ–‡æœ¬åˆ’åˆ†ä¸ºå¾…å¤„ç†åŒºé—´ã€‚
    *   åœ¨åŒºé—´å†…æ’å…¥ `[ID: 10]` ç­‰åæ ‡æ ‡è®°ã€‚
    *   LLM ç»“åˆ Phase 1 çš„è®°å¿†ï¼Œå‘Šè¯‰ç³»ç»Ÿï¼šâ€œè¯·åœ¨ ID 15 å¤„åˆ‡å¼€ï¼Œå› ä¸ºè¿™é‡Œè¯é¢˜ç»“æŸäº†â€ã€‚

---

## ğŸ“„ License

MIT License
